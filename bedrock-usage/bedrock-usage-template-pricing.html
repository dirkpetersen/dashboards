<!DOCTYPE html>
<html>
<head>
    <title>AWS Bedrock Pricing - Cross-Region Inference</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        h1 {
            color: #232f3e;
            border-bottom: 4px solid #ff9900;
            padding-bottom: 15px;
            font-size: 32px;
        }
        .nav-link {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .nav-link:hover {
            transform: translateY(-2px);
        }
        .pricing-note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            color: #856404;
        }
        .pricing-note strong {
            display: block;
            margin-bottom: 5px;
        }
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            padding: 20px;
            border-radius: 12px;
            color: white;
            text-align: center;
            box-shadow: 0 4px 15px rgba(67, 233, 123, 0.4);
        }
        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
        }
        .table-controls {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .search-box {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            width: 300px;
        }
        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }
        .filter-buttons {
            display: flex;
            gap: 10px;
        }
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background-color: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .filter-btn:hover, .filter-btn.active {
            background-color: #667eea;
            color: white;
        }
        .pricing-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .pricing-table thead {
            background-color: #232f3e;
            color: white;
        }
        .pricing-table th {
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .pricing-table th:hover {
            background-color: #1a2530;
        }
        .pricing-table th.sortable::after {
            content: ' ‚áÖ';
            opacity: 0.5;
            font-size: 12px;
        }
        .pricing-table th.sorted-asc::after {
            content: ' ‚ñ≤';
            opacity: 1;
        }
        .pricing-table th.sorted-desc::after {
            content: ' ‚ñº';
            opacity: 1;
        }
        .pricing-table td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        .pricing-table tbody tr {
            transition: background-color 0.2s ease;
        }
        .pricing-table tbody tr:hover {
            background-color: #f8f9fa;
        }
        .pricing-table tbody tr:last-child td {
            border-bottom: none;
        }
        .vendor-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .vendor-anthropic { background-color: #d4a373; color: white; }
        .vendor-amazon { background-color: #ff9900; color: white; }
        .vendor-deepseek { background-color: #667eea; color: white; }
        .vendor-qwen { background-color: #f093fb; color: white; }
        .vendor-ai21 { background-color: #4facfe; color: white; }
        .vendor-cohere { background-color: #43e97b; color: white; }
        .vendor-meta { background-color: #764ba2; color: white; }
        .model-id {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #555;
        }
        .price {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            text-align: right;
        }
        .price-input { color: #4facfe; }
        .price-output { color: #f5576c; }
        .price-total { color: #232f3e; font-size: 16px; }
        .expensive { background-color: #fff3cd; }
        .cheap { background-color: #d4edda; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ AWS Bedrock Pricing</h1>
            <a href="/" class="nav-link">‚Üê Back to Dashboard</a>
        </div>

        <div class="pricing-note">
            <strong>üìç Cross-Region Inference (CRI) Pricing</strong>
            All prices shown are for AWS Bedrock Cross-Region Inference in USD per Million tokens ($/Mtok).
        </div>

        <div class="stats-row">
            <div class="stat-card">
                <h3>Total Models</h3>
                <div class="value">{{ pricing_data|length }}</div>
            </div>
            <div class="stat-card">
                <h3>Cheapest Input</h3>
                <div class="value" id="cheapest-input">$0.00</div>
            </div>
            <div class="stat-card">
                <h3>Cheapest Output</h3>
                <div class="value" id="cheapest-output">$0.00</div>
            </div>
            <div class="stat-card">
                <h3>Most Expensive</h3>
                <div class="value" id="most-expensive">$0.00</div>
            </div>
        </div>

        <div class="table-controls">
            <input type="text" id="searchBox" class="search-box" placeholder="üîç Search models or vendors...">
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterVendor('all')">All</button>
                <button class="filter-btn" onclick="filterVendor('anthropic')">Anthropic</button>
                <button class="filter-btn" onclick="filterVendor('amazon')">Amazon</button>
                <button class="filter-btn" onclick="filterVendor('openai')">OpenAI</button>
                <button class="filter-btn" onclick="filterVendor('deepseek')">DeepSeek</button>
                <button class="filter-btn" onclick="filterVendor('qwen')">Qwen</button>
            </div>
        </div>

        <table class="pricing-table" id="pricingTable">
            <thead>
                <tr>
                    <th class="sortable" onclick="sortTable(0)">Vendor</th>
                    <th class="sortable" onclick="sortTable(1)">Model ID</th>
                    <th class="sortable" onclick="sortTable(2)">Output ($/Mtok)</th>
                    <th class="sortable sorted-desc" onclick="sortTable(3)">Input ($/Mtok)</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                {% for model in pricing_data %}
                <tr data-vendor="{{ model.vendor.lower() }}" data-input="{{ model.input_price_raw }}" data-output="{{ model.output_price_raw }}" class="{% if model['input_price_raw']|float > 5 %}expensive{% elif model['input_price_raw']|float < 0.5 %}cheap{% endif %}">
                    <td>
                        <span class="vendor-badge vendor-{{ model.vendor.lower() }}">{{ model.vendor }}</span>
                    </td>
                    <td class="model-id">{{ model.model_id }}</td>
                    <td class="price price-output">${{ model.output_price }}</td>
                    <td class="price price-input">${{ model.input_price }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <script>
        // Calculate stats
        const rows = document.querySelectorAll('#tableBody tr');
        let minInput = Infinity, minOutput = Infinity, maxInput = 0;

        rows.forEach(row => {
            const cells = row.querySelectorAll('td');
            const output = parseFloat(cells[2].textContent.replace('$', ''));
            const input = parseFloat(cells[3].textContent.replace('$', ''));

            if (input < minInput) minInput = input;
            if (output < minOutput) minOutput = output;
            if (input > maxInput) maxInput = input;
        });

        // Format prices without trailing zeros
        function formatPrice(num) {
            if (num >= 1) return num.toFixed(2);
            if (num >= 0.01) return num.toFixed(4);
            return num.toFixed(6).replace(/\.?0+$/, '');
        }

        document.getElementById('cheapest-input').textContent = '$' + formatPrice(minInput);
        document.getElementById('cheapest-output').textContent = '$' + formatPrice(minOutput);
        document.getElementById('most-expensive').textContent = '$' + formatPrice(maxInput);

        // Search functionality
        document.getElementById('searchBox').addEventListener('keyup', function() {
            const searchTerm = this.value.toLowerCase();
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Filter by vendor
        let currentVendor = 'all';
        function filterVendor(vendor) {
            currentVendor = vendor;
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            rows.forEach(row => {
                if (vendor === 'all' || row.dataset.vendor === vendor) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Sort table
        let sortDirection = { 3: 'asc' };  // Initialize to 'asc' so first toggle goes to 'desc' (most expensive)

        // Apply initial sort by Input cost (descending - most expensive first)
        document.addEventListener('DOMContentLoaded', function() {
            sortTable(3);
        });

        function sortTable(columnIndex) {
            const table = document.getElementById('pricingTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));

            // Toggle sort direction
            const direction = sortDirection[columnIndex] === 'asc' ? 'desc' : 'asc';
            sortDirection[columnIndex] = direction;

            // Update header classes
            table.querySelectorAll('th').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
            });
            const header = table.querySelectorAll('th')[columnIndex];
            header.classList.add(direction === 'asc' ? 'sorted-asc' : 'sorted-desc');

            // Sort rows
            rows.sort((a, b) => {
                let aValue, bValue;

                // For price columns, use data attributes for accurate sorting
                // Column layout: 0=Vendor, 1=ModelID, 2=Output, 3=Input
                if (columnIndex === 2) {
                    aValue = parseFloat(a.dataset.output);
                    bValue = parseFloat(b.dataset.output);
                } else if (columnIndex === 3) {
                    aValue = parseFloat(a.dataset.input);
                    bValue = parseFloat(b.dataset.input);
                } else {
                    aValue = a.cells[columnIndex].textContent.trim();
                    bValue = b.cells[columnIndex].textContent.trim();
                }

                if (aValue < bValue) return direction === 'asc' ? -1 : 1;
                if (aValue > bValue) return direction === 'asc' ? 1 : -1;
                return 0;
            });

            // Reorder rows
            rows.forEach(row => tbody.appendChild(row));
        }
    </script>
</body>
</html>
